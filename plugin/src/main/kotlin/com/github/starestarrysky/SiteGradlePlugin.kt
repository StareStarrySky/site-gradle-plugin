/*
 * This Kotlin source file was generated by the Gradle 'init' task.
 */
package com.github.starestarrysky

import com.github.starestarrysky.extension.GitHubCredentials
import com.github.starestarrysky.extension.GitHubExtension
import com.github.starestarrysky.tasks.GitHubCredentialsAware
import org.gradle.api.Project
import org.gradle.api.Plugin

/**
 * A simple 'hello world' plugin.
 */
class SiteGradlePlugin: Plugin<Project> {
    override fun apply(project: Project) {
        val gitHubExtension = project.extensions.create("github", GitHubExtension::class.java)
        val gitHubCredentials = project.extensions.create("credentials", GitHubCredentials::class.java)
        gitHubExtension.credentials = gitHubCredentials

        project.tasks.withType(GitHubCredentialsAware::class.java).configureEach { task ->
            task.credentials.userName = gitHubExtension.credentials.userName
            task.credentials.password = gitHubExtension.credentials.password
            task.credentials.oauthToken = gitHubExtension.credentials.oauthToken
        }
    }
}
